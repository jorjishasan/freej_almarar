{
  "query": "\n-- Add new tables for locked vision\n\nCREATE TABLE IF NOT EXISTS `ferjan` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `description_en` text,\n  `description_ar` text,\n  `overview_image_url` varchar(500),\n  `timeline_entries` json,\n  `latitude` varchar(50),\n  `longitude` varchar(50),\n  `tags` json,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `is_featured` boolean DEFAULT false NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `family_tree_sections` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `title_en` varchar(200) NOT NULL,\n  `title_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `description_en` text,\n  `description_ar` text,\n  `image_url` varchar(500),\n  `order` int DEFAULT 0 NOT NULL,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `families` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `section_id` int NOT NULL,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `note_en` text,\n  `note_ar` text,\n  `period` varchar(200),\n  `overview_en` text,\n  `overview_ar` text,\n  `tree_structure` json,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `bio_en` text,\n  `bio_ar` text,\n  `role_en` varchar(200),\n  `role_ar` varchar(200),\n  `photo_url` varchar(500),\n  `period` varchar(200),\n  `birth_year` int,\n  `death_year` int,\n  `family_id` int,\n  `position_in_tree` varchar(200),\n  `place_id` int,\n  `place_en` varchar(200),\n  `place_ar` varchar(200),\n  `tags` json,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `is_featured` boolean DEFAULT false NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `collaborations` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `description_en` text,\n  `description_ar` text,\n  `logo_url` varchar(500),\n  `website_url` varchar(500),\n  `internal_link` varchar(500),\n  `category` varchar(100),\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `is_featured` boolean DEFAULT false NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\n-- Add junction tables\nCREATE TABLE IF NOT EXISTS `archive_item_figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `archive_item_id` int NOT NULL,\n  `figure_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `photo_figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `photo_id` int NOT NULL,\n  `figure_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `history_archive_items` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `history_entry_id` int NOT NULL,\n  `archive_item_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `history_photos` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `history_entry_id` int NOT NULL,\n  `photo_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `history_poems` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `history_entry_id` int NOT NULL,\n  `poem_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `figure_history_entries` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `figure_id` int NOT NULL,\n  `history_entry_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `event_figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `event_id` int NOT NULL,\n  `figure_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `event_reposts` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `event_id` int NOT NULL,\n  `repost_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Add new columns to existing tables\nALTER TABLE `archive_items` ADD COLUMN IF NOT EXISTS `document_type` varchar(100);\nALTER TABLE `archive_items` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `archive_items` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `photos` ADD COLUMN IF NOT EXISTS `photo_category` enum('place', 'person', 'event', 'tribe', 'other', 'unknown');\nALTER TABLE `photos` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `photos` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `poems` ADD COLUMN IF NOT EXISTS `figure_id` int;\nALTER TABLE `poems` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `poems` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `books` ADD COLUMN IF NOT EXISTS `figure_id` int;\n\nALTER TABLE `events` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `source_type` enum('instagram', 'twitter', 'facebook', 'manual', 'other') NOT NULL DEFAULT 'manual';\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `caption_en` text;\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `caption_ar` text;\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `media_url` varchar(500);\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `media_type` enum('image', 'video', 'carousel');\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `place_id` int;\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `figure_id` int;\n\nALTER TABLE `history_entries` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `history_entries` ADD COLUMN IF NOT EXISTS `place_id` int;\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway03.us-east-1.prod.aws.tidbcloud.com --port 4000 --user AkWpSa6pzHV4rrZ.root --database G5VwjWqNHFgZmFgcKBK5fD --execute \n-- Add new tables for locked vision\n\nCREATE TABLE IF NOT EXISTS `ferjan` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `description_en` text,\n  `description_ar` text,\n  `overview_image_url` varchar(500),\n  `timeline_entries` json,\n  `latitude` varchar(50),\n  `longitude` varchar(50),\n  `tags` json,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `is_featured` boolean DEFAULT false NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `family_tree_sections` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `title_en` varchar(200) NOT NULL,\n  `title_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `description_en` text,\n  `description_ar` text,\n  `image_url` varchar(500),\n  `order` int DEFAULT 0 NOT NULL,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `families` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `section_id` int NOT NULL,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `note_en` text,\n  `note_ar` text,\n  `period` varchar(200),\n  `overview_en` text,\n  `overview_ar` text,\n  `tree_structure` json,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `bio_en` text,\n  `bio_ar` text,\n  `role_en` varchar(200),\n  `role_ar` varchar(200),\n  `photo_url` varchar(500),\n  `period` varchar(200),\n  `birth_year` int,\n  `death_year` int,\n  `family_id` int,\n  `position_in_tree` varchar(200),\n  `place_id` int,\n  `place_en` varchar(200),\n  `place_ar` varchar(200),\n  `tags` json,\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `is_featured` boolean DEFAULT false NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\nCREATE TABLE IF NOT EXISTS `collaborations` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `name_en` varchar(200) NOT NULL,\n  `name_ar` varchar(200) NOT NULL,\n  `slug` varchar(200) NOT NULL UNIQUE,\n  `description_en` text,\n  `description_ar` text,\n  `logo_url` varchar(500),\n  `website_url` varchar(500),\n  `internal_link` varchar(500),\n  `category` varchar(100),\n  `status` enum('draft', 'review', 'published') DEFAULT 'draft' NOT NULL,\n  `is_featured` boolean DEFAULT false NOT NULL,\n  `author_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  `published_at` timestamp\n);\n\n-- Add junction tables\nCREATE TABLE IF NOT EXISTS `archive_item_figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `archive_item_id` int NOT NULL,\n  `figure_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `photo_figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `photo_id` int NOT NULL,\n  `figure_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `history_archive_items` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `history_entry_id` int NOT NULL,\n  `archive_item_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `history_photos` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `history_entry_id` int NOT NULL,\n  `photo_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `history_poems` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `history_entry_id` int NOT NULL,\n  `poem_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `figure_history_entries` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `figure_id` int NOT NULL,\n  `history_entry_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `event_figures` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `event_id` int NOT NULL,\n  `figure_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS `event_reposts` (\n  `id` int AUTO_INCREMENT PRIMARY KEY,\n  `event_id` int NOT NULL,\n  `repost_id` int NOT NULL,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL\n);\n\n-- Add new columns to existing tables\nALTER TABLE `archive_items` ADD COLUMN IF NOT EXISTS `document_type` varchar(100);\nALTER TABLE `archive_items` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `archive_items` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `photos` ADD COLUMN IF NOT EXISTS `photo_category` enum('place', 'person', 'event', 'tribe', 'other', 'unknown');\nALTER TABLE `photos` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `photos` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `poems` ADD COLUMN IF NOT EXISTS `figure_id` int;\nALTER TABLE `poems` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `poems` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `books` ADD COLUMN IF NOT EXISTS `figure_id` int;\n\nALTER TABLE `events` ADD COLUMN IF NOT EXISTS `place_id` int;\n\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `source_type` enum('instagram', 'twitter', 'facebook', 'manual', 'other') NOT NULL DEFAULT 'manual';\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `caption_en` text;\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `caption_ar` text;\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `media_url` varchar(500);\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `media_type` enum('image', 'video', 'carousel');\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `place_id` int;\nALTER TABLE `reposts` ADD COLUMN IF NOT EXISTS `figure_id` int;\n\nALTER TABLE `history_entries` ADD COLUMN IF NOT EXISTS `period` varchar(200);\nALTER TABLE `history_entries` ADD COLUMN IF NOT EXISTS `place_id` int;\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 18950
}